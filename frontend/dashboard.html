<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ClinicMS — Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Your original CSS -->
  <link rel="stylesheet" href="assets/css/styles.css">
  <!-- The new dashboard CSS -->
  <link rel="stylesheet" href="assets/css/dashboard-styles.css">
</head>
<body>

<!-- The .app-container is the new top-level wrapper -->
<div class="app-container">
  <!-- === Sidebar === -->
  <nav class="sidebar">
    <!-- Sidebar Header -->
    <div class="sidebar-header">
      <a class="sidebar-brand" href="dashboard.html">
        <i class="fas fa-clinic-medical"></i> <!-- Added an icon -->
        <span>ClinicMS</span> <!-- Text is now in a span -->
      </a>
      <!-- Toggle Button -->
      <button class="sidebar-toggle" id="sidebar-toggle">
        <i class="fas fa-chevron-left"></i>
      </button>
    </div>

    <ul class="sidebar-nav">
      <li class="nav-title">General</li>
      <li class="nav-item">
        <a class="nav-link active" href="dashboard.html">
          <i class="fas fa-home"></i>
          <span>Dashboard</span> <!-- Text is now in a span -->
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="patients.html">
          <i class="fas fa-user-injured"></i>
          <span>Patients</span> <!-- Text is now in a span -->
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="appointments.html">
          <i class="fas fa-calendar-check"></i>
          <span>Appointments</span> <!-- Text is now in a span -->
        </a>
      </li>
      <li class="nav-title">Management</li>
      <li class="nav-item">
        <a class="nav-link" href="doctors.html">
          <i class="fas fa-user-md"></i>
          <span>Doctors</span> <!-- Text is now in a span -->
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="bills.html">
          <i class="fas fa-file-invoice-dollar"></i>
          <span>Billing</span> <!-- Text is now in a span -->
        </a>
      </li>
    </ul>
  </nav>

  <!-- === Main Wrapper (Top Bar + Content) === -->
  <div class="main-wrapper">
    <!-- === Top Bar === -->
    <header class="top-bar">
      <!-- Left Side: Search -->
      <form class="search-form d-none d-md-block">
        <input class="form-control" type="search" placeholder="Search...">
      </form>

      <!-- Right Side: User Profile -->
      <div class="profile-dropdown d-flex align-items-center">
        <img src="https://via.placeholder.com/150/4a6cf7/ffffff?text=U" alt="User" class="d-none d-sm-block">
        <div class="me-2 text-end d-none d-sm-block">
          <span id="userLabel" class="d-block"></span>
          <small id="userRoles" class="d-block"></small>
        </div>
        <button id="btnLogout" class="btn btn-logout btn-sm">
          <i class="fas fa-sign-out-alt me-1"></i>Logout
        </button>
      </div>
    </header>

    <!-- === Main Content === -->
    <main class="content-area">
      <!-- Page Title -->
      <h3>Dashboard</h3>
      <p class="page-subtitle">Quick stats overview.</p>

      <!-- Original Stat Cards (now with new styling) -->
      <div class="row" id="statsRow">
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="stat-card">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <div class="stat-title">Doctors</div>
                <div id="statDoctors" class="stat-value">—</div>
              </div>
              <i class="fas fa-user-md stat-icon"></i>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="stat-card">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <div class="stat-title">Patients</div>
                <div id="statPatients" class="stat-value">—</div>
              </div>
              <i class="fas fa-user-injured stat-icon"></i>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="stat-card">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <div class="stat-title">Appointments</div>
                <div id="statAppointments" class="stat-value">—</div>
              </div>
              <i class="fas fa-calendar-check stat-icon"></i>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
          <div class="stat-card">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <div class="stat-title">Total Bills</div>
                <div id="statBills" class="stat-value">—</div>
              </div>
              <i class="fas fa-file-invoice-dollar stat-icon"></i>
            </div>
          </div>
        </div>
      </div>

    </main>
  </div>
</div>

<script src="assets/js/common.js"></script>
<script>
  initCommonNav();
  if (!getToken()) window.location = '/login.html';

  async function loadStats() {
    try {
      const doctors = await apiFetch('/doctor/all');
      document.getElementById('statDoctors').textContent = doctors.length;
    } catch (_) { document.getElementById('statDoctors').textContent = '—'; }
    try {
      const patients = await apiFetch('/patient/all');
      document.getElementById('statPatients').textContent = patients.length;
    } catch (_) { document.getElementById('statPatients').textContent = '—'; }
    try {
      const apps = await apiFetch('/appointment/all');
      document.getElementById('statAppointments').textContent = apps.length;
    } catch (_) { document.getElementById('statAppointments').textContent = '—'; }
    try {
      const bills = await apiFetch('/bill/all');
      document.getElementById('statBills').textContent = bills.length;
    } catch (_) { document.getElementById('statBills').textContent = '—'; }
  }
  loadStats();
</script>

<!-- JavaScript for the sidebar toggle -->
<script>
  document.getElementById('sidebar-toggle').addEventListener('click', function() {
    document.querySelector('.app-container').classList.toggle('sidebar-collapsed');
  });
</script>

</body>
</html>